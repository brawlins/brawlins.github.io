{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/import-tags-from-a-csv","result":{"data":{"markdownRemark":{"html":"<p>Recently I needed to add a large list of tags to a WordPress site. The tags were in a spreadsheet, so I converted it to a CSV file and then wrote a script to import them. Here’s the script:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token comment\">// load WordPress</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'WP_USE_THEMES'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">global</span> <span class=\"token variable\">$wpdb</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'wp-load.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// get tags</span>\n<span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'tags.csv'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">file_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'No file!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$tags</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_getcsv</span><span class=\"token punctuation\">(</span><span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// insert them</span>\n<span class=\"token variable\">$count</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$tags</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">term_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$tag</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'post_tag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;pre>Already have: %s&lt;/pre>'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$tag</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;pre>%d&lt;/pre>'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">++</span><span class=\"token variable\">$count</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">wp_insert_term</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$tag</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'post_tag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// show total</span>\n<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'&lt;pre>%d of %d inserted&lt;/pre>'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$count</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">++</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p>Place this script in the root folder of the your WordPress site, along with the CSV, and then run it from the browser. After you’re done you should delete these files.</p>\n<p>This could easily be modified to import terms into any taxonomy. Just replace “post_tag” with the name of the taxonomy.</p>","frontmatter":{"title":"Import tags from a CSV","date":"February 25, 2014","tags":["wordpress"]},"fields":{"slug":"/blog/import-tags-from-a-csv"}}},"pageContext":{"title":"Import tags from a CSV","prev":{"frontmatter":{"title":"Delete files older than N days on Linux","tags":["command line"]},"excerpt":"Today I needed to delete a bunch of old log files to clear up some room on our server. Here’s a handy shortcut that I found to delete any…","fields":{"slug":"/blog/delete-files-older-than-n-days-on-linux"}},"next":{"frontmatter":{"title":"Apache redirect vs. rewrite","tags":["apache"]},"excerpt":"Apache rewrite rules can be very confusing at times. They're very powerful, but not easily understood or mastered. I don't claim to be an…","fields":{"slug":"/blog/apache-redirect-vs-rewrite"}}}},"staticQueryHashes":["3649515864","63159454"]}